import{S as w,U as h,e as A,u as k,r as g,o as C,f as O,a as m,c as v,d as c,t as f,_ as I,b as T}from"./index-0fc42880.js";/*!
 * paypal-js v5.1.6 (2023-03-27T20:51:02.623Z)
 * Copyright 2020-present, PayPal, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(t,e){var a=document.querySelector('script[src="'.concat(t,'"]'));if(a===null)return null;var r=y(t,e),n=a.cloneNode();if(delete n.dataset.uidAuto,Object.keys(n.dataset).length!==Object.keys(r.dataset).length)return null;var o=!0;return Object.keys(n.dataset).forEach(function(s){n.dataset[s]!==r.dataset[s]&&(o=!1)}),o?a:null}function j(t){var e=t.url,a=t.attributes,r=t.onSuccess,n=t.onError,o=y(e,a);o.onerror=n,o.onload=r,document.head.insertBefore(o,document.head.firstElementChild)}function D(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL),z(t);var a=Object.keys(t).filter(function(o){return typeof t[o]<"u"&&t[o]!==null&&t[o]!==""}).reduce(function(o,s){var l=t[s].toString();return s.substring(0,5)==="data-"?o.dataAttributes[s]=l:o.queryParams[s]=l,o},{queryParams:{},dataAttributes:{}}),r=a.queryParams,n=a.dataAttributes;return{url:"".concat(e,"?").concat(M(r)),dataAttributes:n}}function M(t){var e="";return Object.keys(t).forEach(function(a){e.length!==0&&(e+="&"),e+=a+"="+t[a]}),e}function N(t){var e=t.split("/* Original Error:")[1];return e?e.replace(/\n/g,"").replace("*/","").trim():t}function y(t,e){e===void 0&&(e={});var a=document.createElement("script");return a.src=t,Object.keys(e).forEach(function(r){a.setAttribute(r,e[r]),r==="data-csp-nonce"&&a.setAttribute("nonce",e["data-csp-nonce"])}),a}function z(t){var e=t["merchant-id"],a=t["data-merchant-id"],r="",n="";return Array.isArray(e)?e.length>1?(r="*",n=e.toString()):r=e.toString():typeof e=="string"&&e.length>0?r=e:typeof a=="string"&&a.length>0&&(r="*",n=a),t["merchant-id"]=r,t["data-merchant-id"]=n,t}function P(t,e){if(e===void 0&&(e=x()),S(t,e),typeof document>"u")return e.resolve(null);var a=D(t),r=a.url,n=a.dataAttributes,o=n["data-namespace"]||"paypal",s=b(o);return $(r,n)&&s?e.resolve(s):R({url:r,attributes:n},e).then(function(){var l=b(o);if(l)return l;throw new Error("The window.".concat(o," global variable is not available."))})}function R(t,e){e===void 0&&(e=x()),S(t,e);var a=t.url,r=t.attributes;if(typeof a!="string"||a.length===0)throw new Error("Invalid url.");if(typeof r<"u"&&typeof r!="object")throw new Error("Expected attributes to be an object.");return new e(function(n,o){if(typeof document>"u")return n();j({url:a,attributes:r,onSuccess:function(){return n()},onError:function(){var s=new Error('The script "'.concat(a,'" failed to load.'));return window.fetch?fetch(a).then(function(l){return l.status===200&&o(s),l.text()}).then(function(l){var d=N(l);o(new Error(d))}).catch(function(l){o(l)}):o(s)}})})}function x(){if(typeof Promise>"u")throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function b(t){return window[t]}function S(t,e){if(typeof t!="object"||t===null)throw new Error("Expected an options object.");if(typeof e<"u"&&typeof e!="function")throw new Error("Expected PromisePonyfill to be a function.")}const L=(t,e,a,r,n)=>{const o="Ac2cmdECzIv7NkdPQBqOkzbg22oilC0H88xgV-_d9U-vhoufQeMJCTmjLaPd-a3OISOLloiaKTZkPS2H",s="EJFyf25m64EJJkd_EpBeX-9oDnzyIQIrA6PE4GpRvn580Ipe4tDStRML6EhM9czFXIVpzfX3vaIKgIS8";fetch("https://www.paypal.com/v1/oauth2/token/",{method:"POST",headers:{Authorization:`Basic ${window.btoa(`${o}:${s}`)}`,"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache",Accept:"*/*","Accept-Encoding":"gzip,deflate",Connection:"keep-alive"},body:"grant_type=client_credentials"}).then(l=>l.json()).then(l=>{const{access_token:d}=l;J(d,t,e,a,r,n)})},J=(t,e,a,r,n,o)=>{fetch("https://www.paypal.com/v2/checkout/orders/"+e,{headers:{Authorization:"Bearer "+t}}).then(s=>s.json()).then(s=>{s.status=="APPROVED"&&U(t,e,a,r,n,o)})},U=(t,e,a,r,n,o)=>{let s=`${n}_${o}`;w.fire({icon:"warning",title:"Terminando proceso de pago",text:"Espere por favor!!",showConfirmButton:!1,allowOutsideClick:!1}),fetch(`${h}sendPayment.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`monto=${a}&access_token=${t}&receiver=${r}&orderID=${e}&id_file=${n}&file_name=${s}`}).then(l=>l.json()).then(l=>{fetch(`${h}getLinkDownload.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"file="+s}).then(d=>d.blob()).then(d=>{let i=new FileReader;i.onload=u=>{let p=window.document.createElement("a");p.innerText="Download File",p.setAttribute("download",""),p.href=u.target.result,p.click(),document.querySelector("#_download_").appendChild(p)},i.readAsDataURL(d)}),setTimeout(()=>{w.fire({icon:"success",position:"top-end",toast:!0,title:"Pago exitoso!!",showConfirmButton:!1,allowOutsideClick:!1,timer:4e3});let d={orderID:e,monto:a,email_paypal:r,id_file:n,file_name:o};if(!localStorage.getItem("compras"))localStorage.setItem("compras",JSON.stringify(d));else{let i=[],u=JSON.parse(localStorage.getItem("compras"));i.push(d,u),localStorage.setItem("compras",JSON.stringify(i))}},1100)})},q={class:"container-fluid bg-light p-4 d-flex align-items-center justify-content-center min-vh-100 flex-column"},F=c("img",{src:I,alt:"Logo PaidJobs",width:"250",class:"my-5"},null,-1),H={class:"d-flex justify-content-between align-items-center"},Q={class:"lead",style:{"text-shadow":"0px 1px 1px gray"}},V=c("p",{id:"_download_"},null,-1),K=["title"],W={class:"d-flex align-items-center"},X=c("div",null,[c("i",{class:"bi bi-file-earmark-zip-fill text-primary display-4"})],-1),Z={class:"d-flex justify-content-between position-relative"},G={class:"text-truncate mx-2",style:{width:"270px","font-family":"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif"}},Y={class:"p-2 d-block mx-1 position-absolute",style:{left:"-5px",bottom:"-20px","font-size":"12px"}},ee={class:"text-secondary d-flex justify-content-between px-2 p-2"},te={style:{"max-width":"350px",margin:"auto"}},ne=c("summary",null,"Description",-1),ae={key:0,class:"text-secondary mt-2 bg-white p-2"},re={key:1,class:"text-secondary text-center mt-3"},oe=c("div",{class:"mt-5"},[c("div",{id:"paypal-button-container"})],-1),se={__name:"FileView",setup(t){const e=A(),a=k(),r=g(""),n=g({});C(T,i=>{i&&(r.value=i.email)});const o=()=>{w.fire({icon:"error",title:"Archivo no encontrado!!",html:`
            <div>
                <p>El archivo posiblemente ha caducado.</p>
                <small>Pongase en contacto con su publicador.</small>
            </div>
        `,showConfirmButton:!1}).then(()=>{a.push({name:"home"})})};O(()=>{e.params.id&&(fetch(`${h}file.php?id=${e.params.id}`).then(i=>i.json()).then(i=>{if(i._block==1){o();return}n.value=i}).catch(i=>{o()}),P({"client-id":"Ac2cmdECzIv7NkdPQBqOkzbg22oilC0H88xgV-_d9U-vhoufQeMJCTmjLaPd-a3OISOLloiaKTZkPS2H"}).then(i=>{i.Buttons({style:{layout:"vertical",color:"gold",shape:"rect",label:"pay"},createOrder:function(u,p){return p.order.create({purchase_units:[{amount:{value:n.value._price}}]})},onApprove:function(u,p){L(u.orderID,n.value._price,n.value._email_paypal,e.params.id,n.value._filename)},onCancel:function(u){}}).render("#paypal-button-container")}))});function s(i,u=2){if(!+i)return"0 Bytes";const p=1024,E=u<0?0:u,B=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],_=Math.floor(Math.log(i)/Math.log(p));return`${parseFloat((i/Math.pow(p,_)).toFixed(E))} ${B[_]}`}const l=i=>`${new Date(i)}`.slice(0,24),d=()=>{r.value?fetch(`${h}reporte.php`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"reportar=true&denunciante="+r.value+"&email="+n.value._email+"&_email_paypal="+n.value._email_paypal}).then(i=>i.text()).then(i=>{alert("Se a enviado el reporte!")}):alert("Necesitas tener una cuenta para emitir un reporte!")};return(i,u)=>(m(),v("div",q,[F,c("div",null,[c("p",H,[c("b",Q,"$ "+f(n.value._price)+" USD",1)]),V,c("div",{title:n.value.type,class:"bg-white border rounded p-3"},[c("div",W,[X,c("div",Z,[c("div",G,[c("b",null,f(n.value._filename),1),c("span",Y," Caduca en "+f(n.value._limit)+" "+f(n.value._limit==1?"día":"días"),1)])])])],8,K),c("div",ee,[c("small",null,f(l(parseInt(n.value._date))),1),c("small",null,f(s(n.value._size)),1)]),c("div",te,[c("details",null,[ne,c("div",null,[n.value._description?(m(),v("p",ae,f(n.value._description),1)):(m(),v("p",re," No description! "))])])]),oe,c("button",{class:"btn text-danger w-100 my-4",onClick:d},"Reportar como estafa")])]))}};export{se as default};
